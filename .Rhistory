LINE_embedding2 <- LINE_embedding
LINE_embedding2[,c(3:102)] = scale(LINE_embedding2[,c(3:102)])
View(LINE_embedding2)
ggplot(LINE_embedding2) + geom_point(aes(x=V3,y=V4,color=kmean_compartment))
library(ggplot2)
ggplot(LINE_embedding2) + geom_point(aes(x=V3,y=V4,color=kmean_compartment))
ggplot(LINE_embedding) + geom_point(aes(x=umap1,y=umap2,color=kmean_compartment))
ggplot(LINE_embedding2) + geom_point(aes(x=V3,y=V4,color=kmean_compartment))
LINE_embedding <- read.csv("../../../data/embedding/indexed_GM12878_line_embedding_HiC_graph_order_3_samples_25M.embedding", sep = "\t", header= FALSE)
##########################
LINE_embedding$chr_num = as.numeric(substring(LINE_embedding$V1,4))
LINE_embedding <- LINE_embedding[order(LINE_embedding$chr_num,
LINE_embedding$V2),]
LINE_embedding[,c(3:102)] = scale(LINE_embedding[,c(3:102)])
range(LINE_embedding$V3)
range(LINE_embedding$V4)
range(LINE_embedding$V5)
summary(LINE_embedding$V5)
LINE_kmeans <- kmeans(LINE_embedding[,c(3:102)], centers = 5, nstart = 25)
LINE_one_feature_kmeans <- kmeans(LINE_embedding[,3], centers = 5, nstart = 25)
LINE_embedding$kmean_compartment = LINE_kmeans$cluster
LINE_embedding$one_feature_kmean_compartment = LINE_one_feature_kmeans$cluster
LINE_embedding[,c(105,106)]
ggplot(LINE_embedding) + geom_point(aes(x=V3,y=V4,color=kmean_compartment))
ggplot(LINE_embedding) + geom_point(aes(x=V3,y=V4,color=one_feature_kmean_compartment))
LINE.umap = umap(LINE_embedding[,c(3:102)])
##########################
library(umap)
LINE.umap = umap(LINE_embedding[,c(3:102)])
LINE_embedding[,c("umap1", "umap2")] = LINE.umap$layout
ggplot(LINE_embedding) + geom_point(aes(x=umap1,y=umap2,color=kmean_compartment))
ggplot(LINE_embedding) + geom_point(aes(x=umap1,y=umap2,color=one_feature_kmean_compartment))
ggplot(LINE_embedding) + geom_point(aes(x=umap1,y=umap2,color=kmean_compartment))
ggplot(LINE_embedding) + geom_point(aes(x=umap1,y=umap2,color=one_feature_kmean_compartment))
LINE_KR_embedding <- read.csv("../../../data/embedding/indexed_GM12878_KR_line_embedding_HiC_graph_order_3_samples_25M.embedding", sep = "\t", header= FALSE)
LINE_KR_embedding$chr_num = as.numeric(substring(LINE_KR_embedding$V1,4))
LINE_KR_embedding <- LINE_KR_embedding[order(LINE_KR_embedding$chr_num,
LINE_KR_embedding$V2),]
LINE_KR_embedding[,c(3:102)] = scale(LINE_KR_embedding[,c(3:102)])
View(LINE_KR_embedding)
LINE_KR_embedding <- read.csv("../../../data/embedding/indexed_GM12878_KR_line_embedding_HiC_graph_order_3_samples_25M.embedding", sep = "\t", header= FALSE)
LINE_KR_embedding$chr_num = as.numeric(substring(LINE_KR_embedding$V1,4))
LINE_KR_embedding <- LINE_KR_embedding[order(LINE_KR_embedding$chr_num,
LINE_KR_embedding$V2),]
LINE_KR_embedding[,c(3:102)] = scale(LINE_KR_embedding[,c(3:102)])
LINE_KR_kmeans <- kmeans(LINE_KR_embedding[,c(3:102)], centers = 5, nstart = 25)
summary(LINE_KR_embedding[,3])
LINE_KR_one_feature_kmeans <- kmeans(LINE_KR_embedding[,3], centers = 5, nstart = 25)
LINE_KR_embedding$kmean_compartment = LINE_KR_kmeans$cluster
LINE_KR_embedding$one_feature_kmean_compartment = LINE_KR_one_feature_kmeans$cluster
ggplot(LINE_KR_embedding) + geom_point(aes(x=V3,y=V4,color=kmean_compartment))
ggplot(LINE_KR_embedding) + geom_point(aes(x=V3,y=V4,color=one_feature_kmean_compartment))
LINE_KR.umap = umap(LINE_KR_embedding[,c(3:102)])
LINE_KR_embedding[,c("umap1", "umap2")] = LINE_KR.umap$layout
ggplot(LINE_KR_embedding) + geom_point(aes(x=umap1,y=umap2,color=kmean_compartment))
ggplot(LINE_KR_embedding) + geom_point(aes(x=umap1,y=umap2,color=one_feature_kmean_compartment))
library(ggplot2)
ggplot(LINE_embedding) + geom_point(aes(x=umap1,y=umap2,color=V3))
ggplot(LINE_embedding[LINE_embedding$V3<=5,]) + geom_point(aes(x=umap1,y=umap2,color=V3))
rnorm(10,0,1)
X = data.frame(X1 = rnorm(1000,0,1))
X$X2 = X$X1
X$X3 = X$X1
X$X4 = X$X1
library(umap)
X.umap = umap(X)
X[,c("umap1","umap2")] = X.umap$layout
ggplot(X) + geom_point(aes(x=umap1, y=umap2))
ggplot(X) + geom_point(aes(x=umap1, y=umap2, color=X1))
Y = data.frame(Y1 = rnorm(1000,0,1), Y2 = rnorm(1000,0,1), Y3 = rnorm(1000,0,1),
Y4 = rnorm(1000,0,1))
Y.umap = umap(Y)
Y[,c("umap1", "umap2")] = Y.umap$layout
ggplot(y) + geom_point(aes(x=umap1, y=umap2, color = Y1))
ggplot(Y) + geom_point(aes(x=umap1, y=umap2, color = Y1))
Z = data.frame(Z1 = rnorm(1000,0,1), Z2 = rnorm(1000,0,1))
Z.umap = umap(Z)
Z[,c("umap1","umap2")] = Z.umap$layout
ggplot(Z) + geom_point(aes(x=umap1, y=umap2, color = Z1))
Z = data.frame(Z1 = rnorm(1000,0,1))
Z.umap = umap(Z)
Z[,c("umap1","umap2")] = Z.umap$layout
ggplot(Z) + geom_point(aes(x=umap1, y=umap2, color = Z1))
library(ggplot2)
ggplot(LINE_embedding) + geom_point(aes(x=umap1,y=umap2,color=kmean_compartment))
ggplot(LINE_KR_embedding) + geom_point(aes(x=umap1,y=umap2,color=kmean_compartment))
table(LINE_KR_embedding$kmean_compartment)
table(LINE_embedding$kmean_compartment)
LINE_KR_compartments <- read.csv("../../../data/annotations/GM12878_KR_line_embedding_compartments.txt",
header = FALSE, sep = "\t")
View(LINE_KR_compartments)
table(LINE_KR_compartments$V4)
t <- read.csv("../../../data/HiC/50kb/chrom1_OtoE.txt", sep = "\t", header = FALSE)
t[1,]
t <- read.csv("../../../data/HiC/50kb/chrom21_OtoE.txt", sep = " ", header = FALSE)
View(t)
plot(density(t$V3))
w <- rweibull(n=100,shape = 2, scale = 1)
library(MASS)
fitdistr(w,densfun = "weibull")
fitdistr(t$V3, densfun = "weibull")
length(t$V3)
qqplot(t$V3,rweibull(n=224188,shape=1.066,scale=2.043))
range(t$V3)
log(2)
log(2,base = 2)
log(c(2,4),base=2)
w <- log(t$V3,base=2)
fitdistr(w,densfun = "weibull")
fitdistr(w,densfun = "weibull")
range(w)
plot(density(w))
plot(density(t$V3))
t2 <- read.csv("../../../data/HiC/50kb/chrom18_OtoE.txt", sep = " ", header = FALSE)
plot(density(t2$V3))
plot(density(t$V3))
plot(density(t2$V3))
plot(density(t$V3[t$V3<35,]))
plot(density(t$V3[t$V3<35]))
library(MASS)
fitdistr(t$V3)
fitdistr(t$V3, densfun = "weibull")
qqplot(rweibull(224188,1.066,2.043),t$V3)
tt <- t$V3[t$V3<30]
fitdistr(tt,densfun = weibull)
fitdistr(tt,densfun = "weibull")
length(tt)
qqplot(rweibull(length(tt),1.233,2.011),tt)
help("fitdistr")
fitdistr(tt,densfun = "gamma")
qqplot(rgamma(length(tt),1.719,0.923),tt)
plot(density(tt))
plot(density(log(tt,base=2)))
plot(density(log(t$V3,base=2)))
tt <- log(t$V3, base=2)
help("fitdistr")
fitdistr(tt,densfun = "normal")
qqplot(rnormal(length(tt),0.4476,1.1751),tt)
qqplot(rnorm(length(tt),0.4476,1.1751),tt)
help("pnorm")
pnorm(0.44,0.44,1.175)
pnorm(1.44,0.44,1.175)
pnorm(2.44,0.44,1.175)
qnorm(0.0005,0.44,1.75)
qnorm(0.0005,0.44,1.75,lower.tail = FALSE)
length(tt[tt>6.19])
qnorm(0.00001,0.44,1.75,lower.tail = FALSE)
length(tt[tt>7.9])
qnorm(0.05,0.44,1.75,lower.tail = FALSE)
length(tt[tt>3.31])
View(SNIPER_embedding)
nrow(SNIPER_embedding)
SNIPER_embedding$kmean_compartment
SNIPER_embedding$kmean_compartment - c(0,SNIPER_embedding$kmean_compartment[1:])
SNIPER_embedding$kmean_compartment[1:]
SNIPER_embedding$kmean_compartment[-1]
SNIPER_embedding$kmean_compartment - c(0,SNIPER_embedding$kmean_compartment[-length(SNIPER_embedding$kmean_compartment)])
sum(x!=0)
x!=0
x
x <- SNIPER_embedding$kmean_compartment - c(0,SNIPER_embedding$kmean_compartment[-length(SNIPER_embedding$kmean_compartment)])
x
x!=0
sum(x!=0)
library(dplyr)
library(ggplot2)
library(gridExtra)
assign_colnames_bed <- function(df){
colnames(df) = c("chrom", "chromStart", "chromEnd", "name", "score",
"strand", "thickStart", "thickEnd", "itemRgb")
return(df)
}
fix_vir_coordinates <- function(df, vir_res){
df[,c("chromStart", "chromEnd", "thickStart", "thickEnd")] =
df[,c("chromStart", "chromEnd", "thickStart", "thickEnd")] * vir_res
return(df)
}
read_bedgraph <- function(file_path, vir_res){
df <- read.table(file_path)
df <- assign_colnames_bed(df)
df <- fix_vir_coordinates(df, vir_res)
df <- format(df, scientific = FALSE)
df$chromStart = as.numeric(df$chromStart)
df$chromEnd = as.numeric(df$chromEnd)
return(df)
}
seq_annotation <- function(df, chr_name, start, end, resolution){
df = filter(df, chrom == chr_name & start < chromEnd & chromStart < end)
df[1,"chromStart"] = start
df[nrow(df), "chromEnd"] = end
seq_annot = rep(df$name, ceiling((df$chromEnd - df$chromStart)/resolution))
return(seq_annot)
}
seq_plot <- function(seq_annot){
ggplot() +
geom_line(aes(x = seq(length(seq_annot)), y = 1, color = as.integer(seq_annot)),
size = 6) +
theme(axis.line=element_blank(),axis.text.x=element_blank(),
axis.text.y=element_blank(),axis.ticks=element_blank(),
axis.title.x=element_blank(),axis.title.y=element_text(size=12, face = "bold"),
legend.position="none", panel.background=element_blank(),
panel.border=element_blank(),panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),plot.background=element_blank())
}
label_freq <- function(df, chr_name, start, end, resolution){
df$chromStart = as.numeric(df$chromStart)
df$chromEnd = as.numeric(df$chromEnd)
start = as.numeric(start)
end = as.numeric(end)
num_labels = length(unique(df$name[!is.na(df$name)]))
labels = seq(num_labels)
names(labels) = as.vector(unique(df$name[!is.na(df$name)]))
label_freq = rep(0, num_labels)
df = filter(df, chrom == chr_name & chromEnd > start & chromStart < end)
label_indices = labels[as.vector(df$name)]
label_freq[label_indices[1]] = label_freq[label_indices[1]] +
(min(df$chromEnd[1], end) - start)/resolution
if (nrow(df) > 1){
label_freq[label_indices[nrow(df)]] = label_freq[label_indices[nrow(df)]] +
(end - df$chromStart[nrow(df)])/resolution
if(nrow(df) > 2){
for (i in c(2:(nrow(df)-1))){
label_freq[label_indices[i]] = label_freq[label_indices[i]] +
(df$chromEnd[i] - df$chromStart[i])/resolution
}
}
}
return(label_freq)
}
enrichment <- function(df, chrom_name, start, end){
df$chromStart = as.numeric(df$chromStart)
df$chromEnd = as.numeric(df$chromEnd)
start = as.numeric(start)
end = as.numeric(end)
df = filter(df, chrom == chr_name & chromEnd > start & chromStart < end)
df[1,"chromStart"] = start
if(nrow(df) == 1){
df[1,"chromEnd"] = end
}
}
#####make_ratio_table
ratio_table <- function(table){
row_sum = apply(table, 1, FUN = sum)
col_sum = apply(table, 2, FUN = sum)
row_prop = row_sum / sum(row_sum)
col_prop = col_sum / sum(col_sum)
expected_prop = row_prop %*% t(col_prop)
expected_table = expected_prop * sum(table)
return(table/expected_table)
}
fold_enrichment <- function(df1, df2, resolution){
labels_name = as.vector(unique(df2$name[!is.na(df2$name)]))
num_labels = length(labels_name)
df1[,10:(9+num_labels)] <- t(apply(df1[,1:3],1,
function(x) label_freq(df2,x[1],
x[2],x[3],resolution)))
colnames(df1)[10:(9+num_labels)] = labels_name
enrichment_table = data.frame()
df1_labels_name = as.vector(unique(df1$name[!is.na(df1$name)]))
for (i in df1_labels_name){
f_df1 = df1[df1$name==i & !is.na(df1$name),]
domain_freq = apply(f_df1[,10:(9+num_labels)], 2, function(x) sum(x))
enrichment_table = rbind(enrichment_table, domain_freq)
}
rownames(enrichment_table) = df1_labels_name
colnames(enrichment_table) = labels_name
enrichment_table = round(ratio_table(enrichment_table), 3)
return(enrichment_table)
}
HiC_mat <- function(COO, resolution){
COO_data <- read.table(COO)
COO_data$V1 = COO_data$V1 / resolution
COO_data$V2 = COO_data$V2 / resolution
print(head(COO_data))
HiC_mat <- as.matrix(sparseMatrix(i=COO_data[,1], j=COO_data[,2],
x=COO_data[,3], symmetric = TRUE))
HiC_mat[is.na(HiC_mat)] = 0
return(HiC_mat)
}
OtoE_HiC_mat <- function(COO, resolution){
COO_data <- read.table(COO)
COO_data$V1 = COO_data$V1 / resolution
COO_data$V2 = COO_data$V2 / resolution
expected_contact <- COO_data %>% group_by(V2 - V1) %>%
summarise(expected_contact = mean(V3, na.rm = T))
exp_contact <- expected_contact$expected_contact
names(exp_contact) = expected_contact$`V2 - V1`
COO_data$OtoE = COO_data$V3 / exp_contact[as.character(COO_data$V2 - COO_data$V1)]
print(head(COO_data))
OtoE_mat <- as.matrix(sparseMatrix(i=COO_data[,1], j=COO_data[,2],
x=COO_data[,4], symmetric = TRUE))
OtoE_mat[is.na(OtoE_mat)] = 0
return(OtoE_mat)
}
SC = read_bedgraph("../../../data/annotations/GSE63525_GM12878_subcompartments.bed", 1)
View(SC)
FA = read_bedgraph("../../../data/annotations/segway_func_assays.bed", vir_res = 100000)
View(FA)
fold_enrichment(SC,FA,1)
fold_enrichment <- function(df1, df2, resolution){
labels_name = as.vector(unique(df2$name[!is.na(df2$name)]))
num_labels = length(labels_name)
df1[,10:(9+num_labels)] <- t(apply(df1[,1:3],1,
function(x) label_freq(df2,x[1],
x[2],x[3],resolution)))
colnames(df1)[10:(9+num_labels)] = labels_name
enrichment_table = data.frame()
df1_labels_name = as.vector(unique(df1$name[!is.na(df1$name)]))
for (i in df1_labels_name){
f_df1 = df1[df1$name==i & !is.na(df1$name),]
domain_freq = apply(f_df1[,10:(9+num_labels)], 2, function(x) sum(x))
enrichment_table = rbind(enrichment_table, domain_freq)
}
rownames(enrichment_table) = df1_labels_name
colnames(enrichment_table) = labels_name
#enrichment_table = round(ratio_table(enrichment_table), 3)
return(enrichment_table)
}
fold_enrichment(SC,FA,1)
t <- fold_enrichment(SC,FA,1)
t/100000
t/100000[-1,]
t/100000[-1]
apply(t,MARGIN=1, FUN=max)
t = t/100000
apply(t,MARGIN=1, FUN=max)
best = apply(t,MARGIN=1, FUN=max)
total = apply(t,MARGIN=1, FUN=sum)
best/total
read.csv("../RT.csv", header = TRUE)
read.csv("../RT.csv", header = TRUE, row.names = TRUE)
read.csv("../RT.csv", header = TRUE, row.names = 1)
library(gridExtra)
png("test.png", height = 50*nrow(df), width = 200*ncol(df))
grid.table(df)
dev.off()
df = read.csv("../RT.csv", header = TRUE, row.names = 1)
library(gridExtra)
png("test.png", height = 50*nrow(df), width = 200*ncol(df))
grid.table(df)
dev.off()
df
df = round(df,2)
df
library(gridExtra)
png("test.png", height = 50*nrow(df), width = 200*ncol(df))
grid.table(df)
dev.off()
df = read.csv("../RT.csv", header = TRUE, row.names = 1)
df = round(df,2)
library(gridExtra)
png("test.png", height = 50*nrow(df), width = 200*ncol(df))
grid.table(df)
dev.off()
LINE_embedding <- read.csv("../../../data/embedding/indexed_GM12878_line_embedding_HiC_graph_order_3_samples_25M.embedding", sep = "\t", header= FALSE)
View(LINE_embedding)
cor(LINE_embedding$V3, LINE_embedding$V4)
cor(LINE_embedding$V3, LINE_embedding$V5)
cor(LINE_embedding$V3, LINE_embedding$V50)
LINE_embedding10 <- read.csv("../../../data/embedding/GM12878_KR_line_d10_embedding", sep = "\t", header= FALSE)
View(LINE_embedding10)
LINE_embedding10 <- read.csv("../../../data/embedding/GM12878_KR_line_d10_embedding", sep = " ", header= FALSE)
View(LINE_embedding10)
cor(LINE_embedding10$V2, LINE_embedding10$V3)
cor(LINE_embedding10$V2, LINE_embedding10$V4)
cor(LINE_embedding10[,2:])
cor(LINE_embedding10[,2:11])
View(LINE_embedding)
cor(LINE.embedding[,3:13])
cor(LINE.embedding[,3:102])
cor(LINE_embedding[,3:102])
LINE_embedding10_1st_order <- read.csv("../../../data/embedding/GM12878_KR_line_d10_embedding_1st_order", sep = " ", header= FALSE)
View(LINE_embedding10)
View(LINE_embedding10_1st_order)
LINE_embedding10_1st_order <- read.csv("../../../data/embedding/GM12878_KR_line_d10_embedding_1st_order", sep = " ", header= FALSE)
cor(LINE_embedding10_1st_order[,2:11])
max(LINE_embedding10_1st_order$V2)
LINE_embedding10_2nd_order <- read.csv("../../../data/embedding/GM12878_KR_line_d10_embedding_2nd_order", sep = " ", header= FALSE)
View(LINE_embedding10_2nd_order)
LINE_embedding10_2nd_order <- read.csv("../../../data/embedding/GM12878_KR_line_d10_embedding_2nd_order", sep = " ", header= FALSE)
cor(LINE_embedding10_2nd_order[,2:11])
LINE_embedding10_1st_order <- read.csv("../../../data/embedding/_order_1_samples_25M.embedding", sep = " ", header= FALSE)
cor(LINE_embedding10_1st_order[,2:11])
LINE_embedding10_1st_order <- read.csv("../../../data/embedding/GM12878_KR_line_d10_embedding_1st_order", sep = " ", header= FALSE)
cor(LINE_embedding10_1st_order[,2:11])
chr16_17_OE_KR = read.csv("../../../data/HiC/oe_KR.txt")
chr16_17_observed_KR = read.csv("../../../data/HiC/observed_KR.txt")
chr16_17_OE_KR = read.csv("../../../data/HiC/oe_KR.txt", sep = "\t")
chr16_17_observed_KR = read.csv("../../../data/HiC/observed_KR.txt", sep = "\t")
View(chr16_17_observed_KR)
View(chr16_17_OE_KR)
colnames(chr16_17_OE_KR) = c("start", "end", "value")
colnames(chr16_17_observed_KR) = c("start", "end", "value")
chr16_17_observed_KR$value / chr16_17_OE_KR$value
mean(chr16_17_observed_KR$value)
mean(chr16_17_observed_KR$value, na.rm = TRUE)
chr16_bins = 90354753/100000
chr17_bins = 81195210/100000
max(chr16_17_observed_KR$start)
num_pairs = chr16_bins * chr17_bins
sum(chr16_17_observed_KR$value, na.rm=TRUE)/num_pairs
chr16_bins = floor(90354753/100000)
chr17_bins = floor(81195210/100000)
num_pairs = chr16_bins * chr17_bins
sum(chr16_17_observed_KR$value, na.rm=TRUE)/num_pairs
max(chr16_17_observed_KR$end)
wig_path = "../../../data/genomic-assays/vir_res_100000/"
list.dirs(wig_path)
list.files(wig_path)
bedgraph_path = "../../../data/genomic-assays/vir_res_100000/"
f_path = paste(bedgraph_path, "DNase.bedgraph", sep="")
df = read.csv(f, sep = "\t", header = FALSE)
df = read.csv(f_path, sep = "\t", header = FALSE)
View(df)
df[,2] = df[,2]/100000
df[,3] = df[,3]/100000
f_path = paste(bedgraph_path, "DNase.bedgraph", sep="")
df = read.csv(f_path, sep = "\t", header = FALSE)
df[,2] = df[,2]*100000
df[,3] = df[,3]*100000
wig_path = "../../../data/genomic-assays/wigs/"
write.csv(df,file = paste(wig_path,"DNase.bedgraph", sep=""))
require(dplyr)
df = mutate_if(df, is.numeric, as.integer)
write.csv(df,file = paste(wig_path,"DNase.bedgraph", sep=""), row.names = FALSE, col.names = FALSE)
write.csv(df,file = paste(wig_path,"DNase.bedgraph", sep=""), row.names = FALSE,
header = FALSE, quote = FALSE, sep = "\t")
help("write.csv")
write.csv(df,file = paste(wig_path,"DNase.bedgraph", sep=""), row.names = FALSE,
col.names = FALSE, quote = FALSE, sep = "\t")
write.csv(df,file = paste(wig_path,"DNase.bedgraph", sep=""), row.names = FALSE, col.names = FALSE, quote = FALSE, sep = "\t")
write.table(df,file = paste(wig_path,"DNase.bedgraph", sep=""), row.names = FALSE, col.names = FALSE, quote = FALSE, sep = "\t")
f_path = paste(bedgraph_path, "DNase.bedgraph", sep="")
df = read.csv(f_path, sep = "\t", header = FALSE)
df[,2] = df[,2]*100000
df[,3] = df[,3]*100000
require(dplyr)
df = mutate_if(df, is.integer, as.integer)
write.table(df,file = paste(wig_path,"DNase.bedgraph", sep=""), row.names = FALSE, col.names = FALSE, quote = FALSE, sep = "\t")
f_path = paste(bedgraph_path, "DNase.bedgraph", sep="")
df = read.csv(f_path, sep = "\t", header = FALSE)
df[,2] = as.integer(df[,2]*100000)
df[,3] = as.integer(df[,3]*100000)
require(dplyr)
#df = mutate_if(df, is.integer, as.integer)
write.table(df,file = paste(wig_path,"DNase.bedgraph", sep=""), row.names = FALSE, col.names = FALSE, quote = FALSE, sep = "\t")
bedgraph_path = "../../../data/genomic-assays/vir_res_100000/"
wig_path = "../../../data/genomic-assays/wigs/"
for (f in list.files(bedgraph_path)){
f_path = paste(bedgraph_path, f, sep="")
df = read.csv(f_path, sep = "\t", header = FALSE)
df[,2] = as.integer(df[,2]*100000)
df[,3] = as.integer(df[,3]*100000)
write.table(df,file = paste(wig_path,f, sep=""), row.names = FALSE, col.names = FALSE, quote = FALSE, sep = "\t")
}
library(umap)
X = data.frame(X1 = rnorm(1000,0,1))
X$X2 = X$X1
X$X3 = X$X1
X$X4 = X$X1
X.umap = umap(X)
X[,c("umap1","umap2")] = X.umap$layout
ggplot(X) + geom_point(aes(x=umap1, y=umap2, color=X1))
Y = data.frame(Y1 = rnorm(1000,0,1), Y2 = rnorm(1000,0,1), Y3 = rnorm(1000,0,1),
Y4 = rnorm(1000,0,1))
Y.umap = umap(Y)
Y[,c("umap1", "umap2")] = Y.umap$layout
ggplot(Y) + geom_point(aes(x=umap1, y=umap2, color = Y1))
library(ggplot2)
ggplot(Y) + geom_point(aes(x=umap1, y=umap2, color = Y1))
ggplot(X) + geom_point(aes(x=umap1, y=umap2, color=X1))
Z = data.frame(Z1 = rnorm(1000,0,1))
Z.umap = umap(Z)
Z[,c("umap1","umap2")] = Z.umap$layout
ggplot(Z) + geom_point(aes(x=umap1, y=umap2, color = Z1))
ggplot(Y) + geom_point(aes(x=umap1, y=umap2, color = Y1))
ggplot(Z) + geom_point(aes(x=umap1, y=umap2, color = Z1))
help(rnorm)
X1 = data.frame(X11 = rnorm(500,2,1), X12 = rnorm(500,10,1), X13 = rnorm(500,5,1))
X2 = data.frame(X21 = rnorm(500,1,1), X22 = rnorm(500,12,1), X23 = rnorm(500,7,1))
X = rbind(X1,X2)
X.umap = umap(X)
X[,c("umap1","umap2")] = X.umap$layout
ggplot(X) + geom_point(aes(x=umap1, y=umap2, color=X11))
X1 = data.frame(X11 = rnorm(500,2,1), X12 = rnorm(500,10,1), X13 = rnorm(500,5,1))
X2 = data.frame(X11 = rnorm(500,1,1), X12 = rnorm(500,12,1), X13 = rnorm(500,7,1))
X = rbind(X1,X2)
X.umap = umap(X)
X[,c("umap1","umap2")] = X.umap$layout
ggplot(X) + geom_point(aes(x=umap1, y=umap2, color=X11))
km = kmeans(X, centers, iter.max = 10, nstart = 1)
km = kmeans(X, 2, iter.max = 10, nstart = 1)
X1 = data.frame(X11 = rnorm(500,2,1), X12 = rnorm(500,10,1), X13 = rnorm(500,5,1))
X2 = data.frame(X11 = rnorm(500,1,1), X12 = rnorm(500,12,1), X13 = rnorm(500,7,1))
X = rbind(X1,X2)
km = kmeans(X, 2, iter.max = 10, nstart = 1)
X$class = km$cluster
View(X)
X.umap = umap(X)
X[,c("umap1","umap2")] = X.umap$layout
ggplot(X) + geom_point(aes(x=umap1, y=umap2, color=class))
X = data.frame(X1 = rnorm(1000,0,1))
X$X2 = X$X1
X$X3 = X$X1
X$X4 = X$X1
X.umap = umap(X)
X[,c("umap1","umap2")] = X.umap$layout
ggplot(X) + geom_point(aes(x=umap1, y=umap2, color=X1))
Z = data.frame(Z1 = rnorm(1000,0,1))
Z.umap = umap(Z)
Z[,c("umap1","umap2")] = Z.umap$layout
ggplot(Z) + geom_point(aes(x=umap1, y=umap2, color = Z1))
